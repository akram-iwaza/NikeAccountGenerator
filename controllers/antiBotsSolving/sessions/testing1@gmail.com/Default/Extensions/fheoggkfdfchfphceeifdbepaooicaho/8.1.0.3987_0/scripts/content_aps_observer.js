/*!
 * 
 *     MCAFEE RESTRICTED CONFIDENTIAL
 *     Copyright (c) 2023 McAfee, LLC
 *
 *     The source code contained or described herein and all documents related
 *     to the source code ("Material") are owned by McAfee or its
 *     suppliers or licensors. Title to the Material remains with McAfee
 *     or its suppliers and licensors. The Material contains trade
 *     secrets and proprietary and confidential information of McAfee or its
 *     suppliers and licensors. The Material is protected by worldwide copyright
 *     and trade secret laws and treaty provisions. No part of the Material may
 *     be used, copied, reproduced, modified, published, uploaded, posted,
 *     transmitted, distributed, or disclosed in any way without McAfee's prior
 *     express written permission.
 *
 *     No license under any patent, copyright, trade secret or other intellectual
 *     property right is granted to or conferred upon you by disclosure or
 *     delivery of the Materials, either expressly, by implication, inducement,
 *     estoppel or otherwise. Any license under such intellectual property rights
 *     must be expressed and approved by McAfee in writing.
 *
 */(()=>{"use strict";const e="LOCAL_STORE",t="SESSION_STORE",s="CONTENT_HANDLER",o="EXECUTE_COMMAND",n="FOCUS_OR_CREATE_TAB",a="GET_BK_GLOBALS",i="GET_EXTENSION_STATUS",c="GET_TAB_DATA",r="TI_REQUEST",l="PLACEHOLDER_TEXT",m="REMOVE_TAB",u="SEND_TELEMETRY",d="SET_VIEWPORT",E="WHITELIST",_="RESET_NATIVE_SETTING",p="UPDATE_BK_NATIVE_SETTINGS",g="SHOW_SIDEBAR_MAIN",S="GET_POPUP_DATA",T="GET_SETTINGS_DATA",h="RESET_SETTINGS",w="GET_TYPOSQUATTING_DATA",A="IS_FRAME_BLOCKED",I="IS_WHITELISTED",O="ANY_BLOCKED_IFRAMES",N="ANY_BLOCKED_CRYPTOSCRIPTS",C="UNBLOCK_ALL_IFRAMES",b="VIEW_SITE_REPORT",R="SEARCH_ANNOTATION",D="UPDATE_ENGINE_STATS",f="SOCIAL_MEDIA_ANNOTATION",y="UPDATE_RAT_DETECTION_SHOWING_FLAG",L="SEARCH_SUGGEST",v="SAVE_FORM_INFO",P="GET_FORM_INFO_CACHE",k="CLEAR_FORM_INFO_CACHE",F="SAVE_MULTISTEP_LOGIN",U="GET_FD_WEIGHTS",M="GET_FD_EXCEPTIONS",G="GET_FD_CRF_PARAMS",x="CLEAR_DWS_INFO",j="GET_CACHED_DWS_INFO",B="UPDATE_DWS_WHITELIST",W="LAUNCH_IDPS_LOGIN",H="UPDATE_DWS_SHOWN",Y="GET_APS_DETAILS",V="SIGN_UP_FORM_DETECTED",z="SET_FF_POLICY_COLLECTION",$="SET_FF_POLICY_LAST_SHOWN",K="PING_CONTENT_APS_OBSERVER",q="BROADCAST_TO_FOREGROUND";class X{constructor(e){this.pingCommand=e,this.basePingListener()}basePingListener(e=null){chrome.runtime.onMessage.addListener(((t,s,o)=>{if(s.id!==chrome.runtime.id)return;const{command:n,...a}=t;this.additionalData=a,n===this.pingCommand&&(o({content:!0}),"function"==typeof e&&e())}))}}const J={NONE:0,LINKEDIN:1,INSTAGRAM:2,YOUTUBE:4,FACEBOOK:8,TWITTER:16,REDDIT:32},Q=(Object.values(J).reduce(((e,t)=>e+t)),{NONE:"NONE",ONLY_SECURE_SEARCH:"ONLY_SECURE_SEARCH",ALL:"ALL",*[Symbol.iterator](){for(const e of Object.keys(this))yield e}}),{NONE:Z,...ee}=J,te="SET",se="GET",oe={name:"CACHE_TAB_DATA",type:"object"},ne={name:"APS_EMAIL_LINKS",type:"array"};class ae{static getResetValues(){return{blockedIframes:[],cryptoBlockData:null,tabDomainTrusted:!1}}static getDefaultValues(){return ae.getResetValues()}reset(e){this.update(e,ae.getResetValues())}get(e){return ke.localStore.get(oe.name,{})[e]||ae.getDefaultValues()}set(e,t){const s=ke.localStore.get(oe.name,{});s[e]=t,ke.localStore.set(oe.name,s)}delete(e){delete ke.localStore.get(oe.name,{})[e]}update(e,t){const s=this.get(e);this.set(e,{...s,...t})}setTabBlockPageData(e,t){const s=this.get(e);this.set(e,{...s,blockPageData:t})}addBlockedFrame(e,t){const s=this.get(e);s.blockedIframes.push(t),this.update(e,s)}getBlockedFrames(e){return this.get(e).blockedIframes}resetBlockedFrames(e){const t=this.get(e);t.blockedIframes=[],this.update(e,t)}}const ie={GREEN:0,YELLOW:1,RED:2,GREY:3,HACKERSAFE:4,TYPOSQUATTING:5,PHISHING:6,*[Symbol.iterator](){for(const e of Object.keys(this))"GREEN"!==e&&"GREY"!==e&&(yield this[e])}},ce=1,re=2,le=3,me=2,ue="1.0.0.21",de=-1,Ee=0,_e=1,pe=2,ge=3,Se=70,Te=31,he=16,we=1,Ae=chrome.runtime.getURL(""),Ie="ph",Oe="www.siteadvisor.com/",Ne="https://mip.api.mcafeewebadvisor.com/v1/typosquatting?",Ce="https://sadownload.mcafee.com/products/SA/Win/extensions/engines/update.json",be="https://sadownload.mcafee.com/products/SA/Win/extensions/sailor/condition.json",Re="https://threat.api.mcafee.com/",De=new Set(["www.mcafee.com"]);class fe{static PreprocessSecureSearchRegEx(e){return e.trim().split("\n")}static getBrowserSuffix(){const{CH:e,FF:t,EDGE:s}={CH:"_ch",FF:"_ff",IE:"_ie",EDGE:"_ed"},o={};return o[le]=s,o[ce]=t,o[re]=e,o[me]}}const{SYSTEM:ye,USER:Le}={SYSTEM:0,USER:1},ve=fe.getBrowserSuffix(),Pe={DEV_MODE:{scope:ye,name:"dev_mode",value:!1},AFF_ID:{scope:ye,name:"*Affid",value:0},BINARY_VERSION:{scope:ye,name:"version",value:null},EXTENSION_VERSION_CH:{scope:ye,name:"ChromeExtVersion",value:"",writeOnly:!0},EXTENSION_VERSION_FF:{scope:ye,name:"*FirefoxXPIVersion",value:"",writeOnly:!0},EXTENSION_VERSION_ED:{scope:ye,name:"EdgeExtVersion",value:"",writeOnly:!0},BROWSER_TYPE:{scope:ye,name:"browsertype",value:"",writeOnly:!0},USER_AGENT:{scope:ye,name:"useragent",value:"",writeOnly:!0},SUGGESTION_URL:{scope:ye,name:"suggestion_url",value:""},SCRIPT_GENERATED_DEFAULT_SS_URL:{scope:Le,name:`SCRIPT_GENERATED_DEFAULT_SS_URL${ve}`,value:""},SECURE_SEARCH_REGEXES:{scope:Le,name:"SECURE_SEARCH_REGEXES",value:"",preprocess:fe.PreprocessSecureSearchRegEx},SHOW_SEARCH_SETTINGS:{scope:ye,name:"*ShowSearchSettings",value:!0},SECURE_SEARCH_TOAST_STAMP:{scope:Le,name:`*SSDateStampShowedToast${ve}`,value:0},SECURE_SEARCH_ANNOTATION_ONLY:{scope:ye,name:"*OnlyShowAnnotationsOnSecureSearch",value:!0},SECURE_SEARCH_SHOW_ICONS:{scope:Le,name:"*Icons",value:!0},SECURE_SEARCH_CHOICE:{scope:Le,name:`*SSToastChoice${ve}`,value:!1},SS_DEF:{scope:ye,name:`*SS_DEF${ve}`,value:0},ANNOTATIONS_CHOICE_EXPLICIT:{scope:ye,name:`*AnnotationsChoiceExplicit${ve}`,value:!1},CURRENT_SAO_IN_EXTENSION:{scope:Le,name:`*CurrentSAOInExtension${ve}`,value:""},FF_EXTENSION_LAST_TOAST_TIME:{scope:Le,name:"ff_extension_last_toast_time",value:0,writeOnly:!0},FF_EXTENSION_TOAST_COUNT:{scope:Le,name:"ff_extension_toast_count",value:0,writeOnly:!0},CHECKLIST_START_INGORE_DATE_AV:{scope:ye,name:"startIgnoreDateAV",value:"",writeOnly:!0},CHECKLIST_START_IGNORE_DATE_FW:{scope:ye,name:"startIgnoreDateFW",value:"",writeOnly:!0},CHECKLIST_IGNORE_DURACTION:{scope:ye,name:"ignoreDuration",value:"14",writeOnly:!0},CHECKLIST_GRACE_PERIOD_AV:{scope:ye,name:"fixGracePeriodStartDateAV",value:"",writeOnly:!0},CHECKLIST_GRACE_PERIOD_FW:{scope:ye,name:"fixGracePeriodStartDateFW",value:"",writeOnly:!0},CHECKLIST_GRACE_PERIOD_DURATION:{scope:ye,name:"fixGracePeriodDuration",value:"24",writeOnly:!0},CRYPTOJACKING_DISABLED:{scope:ye,name:"CryptojackingDisabled",value:!1},SMA_USER_TOGGLE:{scope:ye,name:`sma_user_toggle${ve}`,value:!1,writeOnly:!0},SMA_ANNOTATION_OPTIONS:{scope:ye,name:`sma_annotation_options${ve}`,value:0,writeOnly:!0},PAGES_SCANNED:{scope:ye,name:"*CounterPagesScanned",value:0},PAGES_BLOCKED:{scope:ye,name:"*CounterPagesBlocked",value:0},DOWNLOADS_SCANNED:{scope:ye,name:"*CounterDownloadsScanned",value:0},DOWNLOADS_BLOCKED:{scope:ye,name:"*CounterDownloadsBlocked",value:0},CRYPTO_BLOCKED:{scope:ye,name:"*CounterCryptoJackingBlocked",value:0},BLOCKPAGE_WHITELIST:{scope:Le,name:"*WhiteList",value:""},TS_WHITELIST:{scope:Le,name:"*TListWhiteList",value:""},CSP_ID_SETTING:{scope:ye,name:"CSPIdValue",value:"__not_available__"},UNINSTALL_SURVEY_ENABLED:{scope:ye,name:"uninstall_survey_enabled",value:!1},UNINSTALL_SURVEY_URL:{scope:ye,name:"uninstall_survey_url",value:""},RAT_DETECTION_ENABLED:{scope:ye,name:"rat_detection_enabled",value:!0},IDPS_FEATURE_ENABLED:{scope:ye,name:"idps_feature_enabled",value:0},APS_COHORT:{scope:ye,name:"aps_cohort",value:0},APS_TOGGLE_SETTING:{scope:ye,name:"aps_toggle_setting",value:!0},ALT_TRIGGER:{scope:ye,name:"alt_triggers_cohort",value:0},ANNOTATION_JOURNEY_COHORT:{scope:ye,name:`annotation_journey_cohort${ve}`,value:0},ANNOTATION_JOURNEY_TOAST:{scope:Le,name:`aj_toast${ve}`,value:null},MTI_CLIENT_ID:{scope:ye,name:"gti_client_id",value:""},DAILY_GREEN_URLS_TO_COLLECT:{scope:ye,name:"daily_green_urls_to_collect",value:0},FEATURE_COLLECTION_ENABLED:{scope:ye,name:"feature_collection_enabled",value:!1}},ke={isTrustCheckRequired:!0,ExtensionTelemetryUrl:null,scheduleManager:null,isNativeConnected:!0,telemetryEngine:null,postInstallationPage:"https://www.mcafee.com/consumer/v/wa-how.html",listenerManager:null,firefoxInternalUUID:"",shadowMode:"closed",browserType:me,sessionStore:null,localStore:null,ffViewports:null,garbageCollector:null,typoCache:null,logger:null,loglevel:null,messageDispatcher:null,port:null,tabData:new ae,useNativeLogger:!1,wasm:null,userAgentInBase64:null,typoSquattingServer:Ne,tldParser:null,cryptoBlacklist:["wss://*.gasolina.ml/*","*://kissdoujin.com/Content/js/c-hive.js*","wss://*.sen-to-zdrowie.ml/*","*://cookiescript.info/libs/*","*://rocks.io/assets/*","*://coin-have.com/c/*","*://coinnebula.com/lib/*","wss://*.coin-have.com/","ws://digger.cryptobara.com/*","ws://*.webminepool.tk/*","*://*.lewd.ninja/static/m.js*","*://tokyodrift.ga/dropyoulike/a-o/*","*://*.2giga.link/hive/lib/*","*://papoto.com/lib/*","*://load.jsecoin.com/*","ws://*.1q2w3.fun/*","*://*/*plugins/ajcryptominer/assets/*","*://monerominer.rocks/miner.php*","*://minemytraffic.com/*","*://*.monerise.com/core/*","*://*.cookiescript.info/libs/*","ws://hive.tubetitties.com/*","wss://*.freecontent.racing/*","wss://*.hodling.faith/*","ws://gtg02.bestsecurepractice.com/proxy","*://cryptoloot.pro/lib/*","*://lmodr.biz/*","*://*.webminepool.com/lib/base.js","ws://*.sen-to-zdrowie.ml/*","ws://*.morningdigit.com/*","*://mine.nahnoji.cz/*","*://*.minescripts.info/*","*://jsecoin.com/server*","*://coinhive.com/lib*","wss://*.webminepool.tk/*","ws://*.monerise.com/proxy/*","*://kisshentai.net/Content/js/c-hive.js*","*://mataharirama.xyz/*","*://*.coinpirate.cf/*","ws://*.playerassets.info/*","wss://*.1q2w3.fun/*","*://*.1q2w3.fun/*","*://anime.reactor.cc/js/ch/cryptonight.wasm*","*://webmine.cz/miner*","wss://ws.l33tsite.info/*","*://coinhive.com/captcha*","wss://www.mutuza.win/proxy","*://*.morningdigit.com/*","ws://*.host.d-ns.ga/*","*://*.doubleclick5.xyz/*","*://miner.pr0gramm.com/xmr.min.js*","*://*.freecontent.bid/*","ws://lewd.ninja/comics/*","wss://*.monerise.com:9333/proxy/*","*://*.webminepool.com/lib/captcha.js","*://coinerra.com/lib/*","*://*.playerassets.info/*","wss://*.webmine.pro/*","wss://lewd.ninja/comics/*","*://*.doubleclick1.xyz/*","ws://*.freecontent.racing/*","*://*.googleanalytcs.com/*","wss://*.coinnebula.com/proxy*","ws://*.monerise.com:9333/proxy/*","ws://*.freecontent.loan/*","*://party-nngvitbizn.now.sh/*","wss://api.l33tsite.info/*","*://coinlab.biz/lib/coinlab.js*","wss://*.monerise.com/proxy/*","ws://www.mutuza.win/proxy","*://jscdndel.com/content/vidm.min.js*","*://listat.biz/*","*://minecrunch.co/web/*","ws://*.chainblock.science/*","*://baiduccdn1.com/lib/*","*://*.mutuza.win/worker.js","*://*.load.jsecoin.com/*","*://ppoi.org/lib/*","wss://*.chainblock.science/*","wss://*.crypto-loot.com/proxy*","wss://gtg02.bestsecurepractice.com/proxy","wss://*.coinhive.com/proxy*","*://coin-hive.com/captcha*","*://jsccnn.com/content/vidm.min.js*","*://monerominer.rocks/scripts/miner.js*","*://*.jsecoin.com/server*","*://server.jsecoin.com/*","wss://*.coin-hive.com/proxy*","*://*.doubleclick4.xyz/*","*://miner.cryptobara.com/client/*","*://*.rocks.io/assets/*","*://*.ppoi.org/lib/*","*://you.tubetitties.com/worker.js*","wss://*.googleanalytcs.com/*","wss://hive.tubetitties.com/*","*://static.reasedoper.pw/*","*://*.ppoi.org/token/*","ws://*.webmine.pro/*","*://you.tubetitties.com/hash.wasm*","*://*.doubleclick3.xyz/*","*://*.turnsocial.com/m.js","ws://*.hodling.faith/*","wss://*.morningdigit.com/*","*://*.ad-miner.com/lib/*","wss://*.2giga.link/wproxy*","ws://*.googleanalytcs.com/*","*://*.doubleclick6.xyz/*","ws://turnsocial.now.sh/*","*://cdn.cloudcoins.co/javascript/cloudcoins.min.js*","*://joyreactor.cc/ws/ch/*","*://minero.pw/miner.min.js*","*://*.webmine.pro/*","*://punchsub.net/chm.js","wss://mine.nahnoji.cz/*","wss://mine.torrent.pw/*","*://*.mutuza.win/lib/*","*://*.kickass.cd/power2/m.js","ws://*.cpu2cash.link/*","*://*.server.jsecoin.com/*","*://*.mutuza.win/processor.js","wss://turnsocial.now.sh/*","*://kiwifarms.net/js/Jawsh/xmr/xmr.min.js*","*://*.rocks.io/proxy*","*://crypto-loot.com/lib*","*://*.chmproxy.bid/lib/*","ws://*.gasolina.ml/*","*://*.stackpathdns.com/assets/javascript/cr.js","*://*.coinblind.com/lib/*","*://miner.pr0gramm.com/pm.min.js*","*://*.bewhoyouare.gq/*","wss://*.zlx.com.br/proxy*","*://a-o.ninja/apk-AO/kingofthenorth/*","*://ad-miner.com/lib/*","*://*.webminepool.com/api/*","*://*.cpu2cash.link/*","*://*.hemnes.win/*","wss://*.cpu2cash.link/*","ws://*.coinpirate.cf/*","ws://ws.l33tsite.info/*","*://digger.cryptobara.com/client/*","*://kickass.cd/m.js*","ws://*.zlx.com.br/proxy*","*://*.doubleclick2.xyz/*","*://*.amazonaws.com/doubleclick13/*","wss://*.freecontent.loan/*","*://*.host.d-ns.ga/*","*://*.candid.zone/youtube.com/*","ws://api.l33tsite.info/*","*://gtg2.bestsecurepractice.com/lib/*","wss://*.host.d-ns.ga/*","*://coin-hive.com/lib*","ws://mine.nahnoji.cz/*","wss://*.playerassets.info/*","*://*.afminer.com/code/*","wss://*.coinpirate.cf/*","*://cookiescriptcdn.pro/libs/*","*://*.goredirect.party/assets/*","*://*.ZLX.COM.BR/assets/min.js*","*://*.ZLX.COM.BR/assets/playermon.js*","*://p.hemnes.win/lib/*","*://gtg02.bestsecurepractice.com/proxy2/*","*://gtg02.bestsecurepractice.com/meri.js","*://gtg02.bestsecurepractice.com/lv.js","*://gtg02.bestsecurepractice.com/worker.js","*://gtg02.bestsecurepractice.com/processor.js","*://gtg02.bestsecurepractice.com/demo.html","*://*.turnsocial.com/c.wasm*","*://*.turnsocial.com/m.js*","*://cdn.minescripts.info/c/*","*://tokyodrift.ga/dropyoulike/backup/c.wasm*","*://punchsub.net/chm2.js","*://*.kickass.cd/webmr4.js","*://*.kickass.cd/m.js","wss://*.authedmine.com/proxy"],trustedDomains:De,nativeSettings:Pe,searchSuggest:null,ratBlacklist:[{domain:"www.beamyourscreen.com",urls:[]},{domain:"www.connectwise.com",urls:["www.connectwise.com/platform/unified-management/control"]},{domain:"get.gotoassist.com",urls:[]},{domain:"fastsupport.gotoassist.com",urls:[]},{domain:"www.join.me",urls:[]},{domain:"www.mikogo.com",urls:[]},{domain:"www.mikogo.de",urls:[]},{domain:"www.securelink.com",urls:[]},{domain:"join.zoho.com",urls:[]}],wssMessageDispatcher:null,wssNativeClient:null,WSS_INSTALLED:!1,isWPSInstalled:!1,searchEngines:null,enginesVersionUrl:Ce,engineCheckInterval:864e5,ENGINES_VERSION:ue,AUTO_PLAY_NOTIFICATION_ENABLED:!1,ALLOW_LOCALHOST:!1,IDPS_AUTH_URL:"https://csptoken.ccs.mcafee.com/auth/token",IDPS_BREACH_COUNT_URL:"https://identity.unifiedapis.mcafee.com/breach/v1/BreachCount",IDPS_CSP_CLIENT_ID:null,IDPS_IS_ENTITLED:!1,IDPS_PROVISION_ID:null,IDPS_LOGIN_DOMAIN:"https://protection.mcafee.com",UA_CLIENT:null,TYPOSQUATTING_MAX_CACHE:100,TYPOSQUATTING_EXPIRY:2592e6,URL_DOWNLOAD_MAX_CACHE:100,URL_DOWNLOAD_EXPIRY:2592e6,WA_IMAGE_SECRET:null,apsUrlList:{shopping:{"www.amazon.com":{paths:["buy/payselect/handlers","buy/addressselect/handlers"]}},email:{"mail.google.com/mail":{selector:"table[role=presentation] > tr div[data-message-id] a"},"outlook.live.com/mail":{selector:"div[role=complementary][aria-label] a"},"outlook.office.com/mail":{selector:"div[role=complementary][aria-label] a"},"outlook.office365.com/mail":{selector:"div[role=complementary][aria-label] a"},"mail.yahoo.com":{selector:"div[role=main] ul li a"}}},apsAnimationTimeout:5e3,wpsRequestedSettings:new Set(["SMA_USER_TOGGLE","SEARCH_ANNOTATION_OPTION","SMA_ANNOTATION_OPTIONS"]),permittedContentTypes:["application/vnd.microsoft.portable-executable","application/octet-stream","application/x-msdos-program","application/x-msdownload","binary/octet-stream","application/x-msdownload"],SUPPORTED_WEBSITE_LIST:["protection.mcafee.com","protection-dev-roadhouse-int.dvqa.mcafee.com","protection-dev2-roadhouse-int.dvqa.mcafee.com","protection-qa-roadhouse-int.dvqa.mcafee.com"],mtiRequestor:null,htiServer:Re,cspClientId:"e87c73de-b45e-4427-b590-5124401795b6",sailer:null,sailorConditionUrl:be},Fe=chrome,Ue=0,Me=0,Ge=1,xe=2,je=3,Be=4,We=1,He=2,Ye=3,Ve=4,ze={BACKGROUND:"BACKGROUND",CONTENT:"CONTENT",TELEMETRY:"TELEMETRY"},$e={DEFAULT:"color: #000000; font-weight: normal; font-style:normal; background: #FFFFFF;",BACKGROUND:"color: #8D0DBA; font-weight: bold; background: #FFFFFF;",CONTENT:"color: #F54A26; font-weight: bold; background: #FFFFFF;",TELEMETRY:"color: #147831; font-weight: bold; background: #FFFFFF;"};class Ke{static log(e,t=null){qe(e,We,t)}static error(e,t=null){qe(e,He,t)}static warn(e,t=null){qe(e,Ye,t)}static debug(e,t=null){qe(e,Ve,t)}}const qe=(e,t,s)=>{const o=Ue;if(o===Me)return;let n="chrome-extension:"===location.protocol?ze.BACKGROUND:ze.CONTENT;s&&ze[s]&&(n=s);const a=new Date,i=t===He?e:`%c[${n} ${a.toLocaleString([],{hour:"2-digit",minute:"2-digit",hour12:!0})}]: %c${e}`,c=$e.DEFAULT;let r=$e[n];if(r||(r=c),o>=xe&&t===He&&console.error(e),o>=Ge&&t===We&&console.log(i,r,c),o>=je&&t===Ye){const e="color: #FFA500; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cWARN - ${i}`,e,r,c)}if(o>=Be&&t===Ve){const e="color: #FF33D7; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cDEBUG - ${i}`,e,r,c)}},Xe={ANNOTATION:{},BackgroundIPC:null,BackgroundCommons:null,ContextTelemetry:null,TelemetryEventNames:null,UrlParser:null,Utils:null,Commands:{},CommonConstants:{},extension:null,SearchEngineHelper:null,prevLink:null,Logger:null};class Je{static getResString(e,t){Xe.ANNOTATION.resourceRequestor.getResStr(e,(s=>{s?t(s):Xe.Logger.error(`Resource string ${e} failed to fetch through resource requestor`)}))}}class Qe{static async toHTICategoriesString(e,t=!1){const s=e=>new Promise((t=>{Je.getResString(e,(e=>t(e)))})),o=async(e,t)=>{const o={},n=await s(`category_id_${e}_name`);if(o.name=n,t){const t=await s(`category_id_${e}_description`);o.description=t}return o},n=[];for(const s of e)n.push(o(s,t));return await Promise.all(n)}static browserTypeToString(e=!1){let t="";switch(me){case 1:t="FF";break;case 2:t="CH";break;case 3:t="ED";break;case 4:t="SF";break;default:t="UN"}return e?t.toLowerCase():t}static toAnnotationImageClass(e){let t="";switch(Qe.toColor(e)){case Ee:t="green";break;case pe:t="red";break;case _e:t="yellow";break;case ge:t="grey"}return t}static isPhishingURI(e){return e&&e.includes(Ie)}static toBlockState(e){const t=Qe.toColor(e);return t!==pe&&t!==_e||!Qe.isPhishingURI(e.category)?isNaN(t)?ie.GREY:t:ie.PHISHING}static toColor(e){let t=de;return void 0===e||void 0===e.trust||(t=e.trust>=Se?Ee:e.trust>=Te?ge:e.trust>=he?_e:e.trust>=we?pe:de),t}static toSiteReportUrl(e){return`${Fe.runtime.getURL("html/site_status_site_report.html")}?url=${escape(e)}`}static isExtensionUrl(e){return e.startsWith(Ae)}static isSafeUrl(e){return Qe.isSiteAdvisorUrl(e)||Qe.isExtensionUrl(e)}static isSiteAdvisorUrl(e){return e.startsWith(`http://${Oe}`)||e.startsWith(`https://${Oe}`)}static isPropertRedirectUrl(e){return Qe.isPropertyWebURL(e)||e.startsWith("edge://")||e.startsWith("chrome://")}static isProperWebURL(e){return!!(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("ftp://"))}static getUINumber(e){if(e>=1e4)return"10k+";if(e>=1e3){let t=(e/1e3).toFixed(1);return t="0"===t.substring(2,3)?t.substring(0,1):t,`${t}k+`}return`${e}`}static hasEpochTimeElapsed(e,t){return(new Date).getTime()/1e3>e+t}static isPersonalPolicyEnabled(){return!0}static isActivityPolicyEnabled(){return!0}static blockRequest(e,t,s){Fe.declarativeNetRequest.getDynamicRules((o=>{0===o.filter((e=>e.condition.urlFilter===t)).length&&Fe.declarativeNetRequest.updateDynamicRules({addRules:[{id:o.length+1,condition:{domains:["<all_urls>"],urlFilter:t,resourceTypes:["main_frame"]},action:{type:"block"}}]},(()=>{Ke.log(`${s} ${t} ${e}`)}))}))}static updateHTIGlobalsAfterNativeConnection(){const e=ke.nativeSettings.MTI_CLIENT_ID,t=ke.nativeSettings.CSP_ID_SETTING;"__not_available__"!==e&&ke.mtiRequestor.setGlobals({clientIdGuid:e}),""!==t&&ke.mtiRequestor.setGlobals({cspid:t})}}class Ze{static getURI(e){let t=e.split("?");return t.length>1?t[0]:(t=e.split("#"),t.length>1?t[0]:e)}static getCleanURI(e){let t=e;return t.endsWith("/")&&(t=t.slice(0,-1)),t.startsWith("http://")?t=t.slice(7):t.startsWith("https://")&&(t=t.slice(8)),this.getURI(t)}static getParam(e,t){const s=e.indexOf("?");if(-1===s)return null;const o=e.substring(s+1).split("&");for(let e=0;e<o.length;++e){const s=o[e].indexOf("=");if(-1===s)continue;if(o[e].substring(0,s)===t){return o[e].substring(s+1)}}return null}static getDomain(e){if(void 0===e||!/^https?:\/\//.test(e))return"";return new URL(e).hostname}static decodeQueryParam(e){return decodeURIComponent(e.replace(/\+/g," "))}}class et{static handlePromiseMessage(e,t=null){return new Promise(((s,o)=>{chrome.runtime.sendMessage(e,(e=>{"function"==typeof t?t(s,o,e):((e,t,s)=>{chrome.runtime.lastError&&t(chrome.runtime.lastError.message),e(s)})(s,o,e)}))}))}}class tt{static localStore(t,s){const o=e;return et.handlePromiseMessage({command:o,action:t,data:s})}static sessionStore(e,s){const o=t;return et.handlePromiseMessage({command:o,action:e,data:s})}static isFrameBlocked(e){const t=A;return et.handlePromiseMessage({command:t,url:e})}static makeMTIRequest(e,t){const s={command:r,requestData:e,referer:t};return et.handlePromiseMessage(s)}static executeCommand(e,t){const s=o;Fe.runtime.sendMessage({command:s,commandId:e,params:t})}static focusOrCreateTab(e){const t=n;Fe.runtime.sendMessage({command:t,url:e})}static closeTab(){const e=m;Fe.runtime.sendMessage({command:e})}static whitelist(e,t,s){const o=E;return et.handlePromiseMessage({action:e,command:o,type:t,data:s})}static getPopupData(){const e=S;return et.handlePromiseMessage({command:e})}static getSettingsData(){const e=T;return et.handlePromiseMessage({command:e})}static searchAnnotation(e,t){const s=R;return et.handlePromiseMessage({action:e,data:t,command:s})}static socialMediaAnnotation(e,t){const s=f;return et.handlePromiseMessage({action:e,data:t,command:s})}static getBkGlobals(e=!1){return new Promise((t=>{const s=a;et.handlePromiseMessage({command:s,bIncludeSearchEngines:e}).then((e=>{t(JSON.parse(e))}))}))}static viewSiteReport(e=null,t=!1){const s=b;Fe.runtime.sendMessage({command:s,url:e,showInNewTab:t})}static getTypoSquattingData(e){const t=w;return et.handlePromiseMessage({command:t,domain:e})}static getPlaceholderText(e){const t=l;return et.handlePromiseMessage({command:t,id:e})}static setViewPort(e,t){const s=d;Fe.runtime.sendMessage({command:s,x:e,y:t})}static sendTelemetry(e){const t=u;Fe.runtime.sendMessage({command:t,telemetry:e})}static anyBlockedIframes(e){const t=O;return et.handlePromiseMessage({command:t,frameUrls:e})}static anyBlockedCryptoScripts(){const e=N;return et.handlePromiseMessage({command:e})}static resetSettings(){const e=h;Fe.runtime.sendMessage({command:e})}static sendEngineStat(e){Fe.runtime.sendMessage({command:D,engine:e})}static contentHandler(e){const t=s;Fe.runtime.sendMessage({command:t,message:e})}static getTabData(e={}){const t={command:c,...e};return et.handlePromiseMessage(t)}static isWhitelisted(e){const t={command:I,url:e};return et.handlePromiseMessage(t)}static getExtensionStatus(e){return et.handlePromiseMessage({command:i,extension_id:e})}static unblockAllIframes(){const e=C;Fe.runtime.sendMessage({command:e})}static updateRatDetectionShowingFlag(e){const t=y;Fe.runtime.sendMessage({command:t,showed:e})}static getSearchSuggest(e){const t={command:L,searchTerm:e};return et.handlePromiseMessage(t)}static resetNativeSetting(e){const t=_;Fe.runtime.sendMessage({command:t,setting:e})}static saveFormInfo(e,t){const s=v;Fe.runtime.sendMessage({command:s,username:e,hostname:t})}static saveMultiStepLogin(e,t){const s=F;Fe.runtime.sendMessage({command:s,data:e,completeLogin:t})}static getFormInfoCache(){const e=P;return et.handlePromiseMessage({command:e})}static clearFormInfoCache(){const e=k;Fe.runtime.sendMessage({command:e})}static updateDWSWhitelist(e){const t=B;Fe.runtime.sendMessage({command:t,email:e})}static getCachedDWSInfo(e){const t={command:j,email:e};return et.handlePromiseMessage(t)}static clearCachedDWSInfo(e){const t=x;Fe.runtime.sendMessage({command:t,email:e})}static updateDWSShown(e){const t=H;Fe.runtime.sendMessage({command:t,email:e})}static getAPSDetails(){const e=Y;return et.handlePromiseMessage({command:e})}static signUpFormDetected(){const e=V;Fe.runtime.sendMessage({command:e})}static updateBkNativeSettings(e,t){const s=p;Fe.runtime.sendMessage({command:s,name:e,value:t})}static launchIDPSLogin(){const e=W;Fe.runtime.sendMessage({command:e})}static showSidebarMain(){const e=g;Fe.runtime.sendMessage({command:e})}static setFFPolicyCollection({personal:e,activity:t,permissions:s}){const o=z;Fe.runtime.sendMessage({command:o,personal:e,activity:t,permissions:s})}static setFFPolicyLastShown(){const e=$;Fe.runtime.sendMessage({command:e})}static broadcastToForeground(e){const t=q;Fe.runtime.sendMessage({command:t,payload:e})}static getFDWeights(){const e=U;return et.handlePromiseMessage({command:e})}static getFDExceptions(){const e=M;return et.handlePromiseMessage({command:e})}static getFDCrfParams(){const e=G;return et.handlePromiseMessage({command:e})}}(new class extends X{constructor(){super(K)}async main(){const e=document.location.href,t=ne.name,s=(await tt.sessionStore(se,{[t]:[]}))[t],{apsUrlList:o}=await tt.getBkGlobals(),n=o.email,a=Object.keys(n).find((t=>e.includes(t)));if(a){const e=n[a].selector;this.initEmailObserver(e,s)}else this.initEmailObserver()}initEmailObserver(e,t){const s=()=>{const s=document.querySelectorAll(e);s.length&&s.forEach((e=>{const s=e.getAttribute("href");"true"!==e.getAttribute("mcafee_aps")&&s&&Qe.isProperWebURL(s)&&(e.setAttribute("mcafee_aps","true"),e.addEventListener("click",(()=>{const e=Ze.getDomain(s);t.push(e),tt.sessionStore(te,{[ne.name]:t})})))}))},o=new MutationObserver((()=>{s()}));s(),o.observe(document,{childList:!0,subtree:!0})}}).main()})();
//# sourceMappingURL=../sourceMap/chrome/scripts/content_aps_observer.js.map